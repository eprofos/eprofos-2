{% extends 'admin/base.html.twig' %}

{% block page_actions %}
    <a href="{{ path('admin_formation_show', {id: formation.id}) }}" class="btn btn-outline-primary">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 7l6 0"/>
            <path d="M9 12l6 0"/>
            <path d="M9 17l6 0"/>
            <path d="M5 7l0 .01"/>
            <path d="M5 12l0 .01"/>
            <path d="M5 17l0 .01"/>
        </svg>
        Retour aux détails
    </a>
    <a href="{{ path('admin_formation_schedule_pdf', {id: formation.id}) }}" class="btn btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
            <path d="M5 12v-7a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-7.5"/>
            <path d="M3 20l6 -6"/>
            <path d="M9 20l-6 -6"/>
        </svg>
        Télécharger PDF
    </a>
{% endblock %}

{% block body %}
    <div class="row row-deck row-cards">
        <!-- Formation Summary -->
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M22 9l-10 -4l-10 4l10 4l10 -4v6"/>
                            <path d="M6 10.6v9.4a6 3 0 0 0 12 0v-9.4"/>
                        </svg>
                        {{ formation.title }}
                    </h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <p class="text-muted mb-2">{{ formation.description }}</p>
                            <div class="row">
                                <div class="col-sm-6">
                                    <strong>Catégorie:</strong> {{ formation.category.name }}<br>
                                    <strong>Niveau:</strong> {{ formation.level }}<br>
                                    <strong>Format:</strong> {{ formation.format }}
                                </div>
                                <div class="col-sm-6">
                                    <strong>Durée officielle:</strong> {{ formation.formattedDuration }}<br>
                                    <strong>Prix:</strong> {{ formation.formattedPrice }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <div class="col-6">
                                    <div class="card card-sm">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="bg-primary text-white avatar">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                            <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"/>
                                                            <path d="M12 7v5l3 3"/>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="col">
                                                    <div class="font-weight-medium">
                                                        {{ scheduleService.formatDuration(scheduleData.totalDuration) }}
                                                    </div>
                                                    <div class="text-muted">
                                                        Durée totale
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="card card-sm">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <span class="bg-success text-white avatar">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                            <path d="M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"/>
                                                            <path d="M16 3l0 4"/>
                                                            <path d="M8 3l0 4"/>
                                                            <path d="M4 11l16 0"/>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="col">
                                                    <div class="font-weight-medium">
                                                        {{ scheduleData.totalDays }}
                                                    </div>
                                                    <div class="text-muted">
                                                        Jour{{ scheduleData.totalDays > 1 ? 's' : '' }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Schedule Statistics -->
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Statistiques du planning</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-primary text-white avatar">{{ scheduleData.summary.itemsByType.module }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">{{ scheduleData.summary.itemsByType.module }} Module{{ scheduleData.summary.itemsByType.module > 1 ? 's' : '' }}</div>
                                            <div class="text-muted">{{ scheduleService.formatDuration(scheduleData.summary.durationByType.module) }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-info text-white avatar">{{ scheduleData.summary.itemsByType.chapter }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">{{ scheduleData.summary.itemsByType.chapter }} Chapitre{{ scheduleData.summary.itemsByType.chapter > 1 ? 's' : '' }}</div>
                                            <div class="text-muted">{{ scheduleService.formatDuration(scheduleData.summary.durationByType.chapter) }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-success text-white avatar">{{ scheduleData.summary.itemsByType.course }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">{{ scheduleData.summary.itemsByType.course }} Cours</div>
                                            <div class="text-muted">{{ scheduleService.formatDuration(scheduleData.summary.durationByType.course) }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-warning text-white avatar">{{ scheduleData.summary.totalExercises + scheduleData.summary.totalQcms }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">Évaluations</div>
                                            <div class="text-muted">{{ scheduleData.summary.totalExercises }} exercices, {{ scheduleData.summary.totalQcms }} QCM</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional statistics row for segments -->
                    <div class="row mt-3">
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-secondary text-white avatar">{{ scheduleData.summary.totalSegments }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">Segments total</div>
                                            <div class="text-muted">{{ scheduleData.summary.totalItems }} éléments d'origine</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-orange text-white avatar">{{ scheduleData.summary.splitItems }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">Éléments divisés</div>
                                            <div class="text-muted">Sur plusieurs séances</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-teal text-white avatar">{{ scheduleData.summary.totalMorningSessions }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">Séances matin</div>
                                            <div class="text-muted">{{ scheduleData.summary.totalAfternoonSessions }} après-midi</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card card-sm">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-auto">
                                            <span class="bg-purple text-white avatar">{{ scheduleData.totalDays }}</span>
                                        </div>
                                        <div class="col">
                                            <div class="font-weight-medium">Jours total</div>
                                            <div class="text-muted">{{ scheduleService.formatDuration(scheduleData.summary.averageDayDuration) }} / jour</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Daily Schedule -->
        {% if scheduleData.days|length > 0 %}
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                <path d="M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"/>
                                <path d="M16 3l0 4"/>
                                <path d="M8 3l0 4"/>
                                <path d="M4 11l16 0"/>
                                <path d="M8 15l0 0"/>
                            </svg>
                            Planning journalier
                        </h3>
                        <div class="card-actions">
                            <span class="text-muted">{{ scheduleData.totalDays }} jour{{ scheduleData.totalDays > 1 ? 's' : '' }} de formation</span>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        {% for day in scheduleData.days %}
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h4 class="card-title">
                                        <span class="badge bg-primary me-2">{{ day.dayNumber }}</span>
                                        Jour {{ day.dayNumber }}
                                        <span class="text-muted ms-2">({{ scheduleService.formatDuration(day.totalDuration) }})</span>
                                    </h4>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <!-- Morning Session -->
                                        {% if day.morning.items|length > 0 %}
                                            <div class="col-md-6">
                                                <h5 class="text-warning mb-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                        <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/>
                                                        <path d="M3 12h1"/>
                                                        <path d="M12 3v1"/>
                                                        <path d="M20 12h1"/>
                                                        <path d="M12 20v1"/>
                                                        <path d="M5.6 5.6l.7 .7"/>
                                                        <path d="M18.4 5.6l-.7 .7"/>
                                                        <path d="M17.7 17.7l.7 .7"/>
                                                        <path d="M6.3 17.7l-.7 .7"/>
                                                    </svg>
                                                    Matin ({{ scheduleService.formatDuration(day.morning.duration) }})
                                                </h5>
                                                
                                                {% set currentModule = null %}
                                                {% set currentChapter = null %}
                                                
                                                {% for item in day.morning.items %}
                                                    {% if item.type == 'module' %}
                                                        {% set currentModule = item %}
                                                        <div class="mb-4">
                                                            <div class="d-flex align-items-center mb-2">
                                                                <span class="badge bg-primary me-2">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                        <path d="M19 4v16l-12 -7l12 -9z"/>
                                                                    </svg>
                                                                    MODULE
                                                                </span>
                                                                <h6 class="mb-0 fw-bold">{{ item.title }}</h6>
                                                                <span class="badge bg-secondary ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-2 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.learningObjectives %}
                                                                <div class="ms-4 mb-2">
                                                                    <strong class="small">Objectifs :</strong>
                                                                    <ul class="small text-muted mb-0">
                                                                        {% for objective in item.learningObjectives|slice(0, 3) %}
                                                                            <li>{{ objective }}</li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% elseif item.type == 'chapter' %}
                                                        {% set currentChapter = item %}
                                                        <div class="mb-3 ms-3">
                                                            <div class="d-flex align-items-center mb-2">
                                                                <span class="badge bg-info me-2">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                        <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                                                                        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                                                                    </svg>
                                                                    CHAPITRE
                                                                </span>
                                                                <h6 class="mb-0">{{ item.title }}</h6>
                                                                <span class="badge bg-secondary ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-2 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.learningObjectives %}
                                                                <div class="ms-4 mb-2">
                                                                    <strong class="small">Objectifs :</strong>
                                                                    <ul class="small text-muted mb-0">
                                                                        {% for objective in item.learningObjectives|slice(0, 2) %}
                                                                            <li>{{ objective }}</li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% elseif item.type == 'course' %}
                                                        <div class="mb-2 ms-5">
                                                            <div class="d-flex align-items-center mb-1">
                                                                <span class="badge bg-success me-2">
                                                                    {% if item.courseType == 'QCM' %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M9 12l2 2l4 -4"/>
                                                                            <path d="M21 12c0 4.97 -4.03 9 -9 9s-9 -4.03 -9 -9s4.03 -9 9 -9s9 4.03 9 9z"/>
                                                                        </svg>
                                                                        QCM
                                                                    {% elseif item.courseType == 'Exercise' %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M12 6l0 12"/>
                                                                            <path d="M6 12l12 0"/>
                                                                        </svg>
                                                                        EXERCICE
                                                                    {% else %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M7 4v16l13 -8z"/>
                                                                        </svg>
                                                                        COURS
                                                                    {% endif %}
                                                                </span>
                                                                <span class="small fw-medium">{{ item.title }}</span>
                                                                <span class="badge bg-light text-dark ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-1 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.exerciseCount > 0 or item.qcmCount > 0 %}
                                                                <div class="ms-4 small text-muted">
                                                                    {% if item.exerciseCount > 0 %}
                                                                        <span class="badge bg-warning text-dark me-1">{{ item.exerciseCount }} exercice{{ item.exerciseCount > 1 ? 's' : '' }}</span>
                                                                    {% endif %}
                                                                    {% if item.qcmCount > 0 %}
                                                                        <span class="badge bg-info text-white">{{ item.qcmCount }} QCM{{ item.qcmCount > 1 ? 's' : '' }}</span>
                                                                    {% endif %}
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                        
                                        <!-- Afternoon Session -->
                                        {% if day.afternoon.items|length > 0 %}
                                            <div class="col-md-6">
                                                <h5 class="text-info mb-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                        <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/>
                                                        <path d="M3 12h1"/>
                                                        <path d="M12 3v1"/>
                                                        <path d="M20 12h1"/>
                                                        <path d="M12 20v1"/>
                                                        <path d="M5.6 5.6l.7 .7"/>
                                                        <path d="M18.4 5.6l-.7 .7"/>
                                                        <path d="M17.7 17.7l.7 .7"/>
                                                        <path d="M6.3 17.7l-.7 .7"/>
                                                    </svg>
                                                    Après-midi ({{ scheduleService.formatDuration(day.afternoon.duration) }})
                                                </h5>
                                                
                                                {% set currentModule = null %}
                                                {% set currentChapter = null %}
                                                
                                                {% for item in day.afternoon.items %}
                                                    {% if item.type == 'module' %}
                                                        {% set currentModule = item %}
                                                        <div class="mb-4">
                                                            <div class="d-flex align-items-center mb-2">
                                                                <span class="badge bg-primary me-2">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                        <path d="M19 4v16l-12 -7l12 -9z"/>
                                                                    </svg>
                                                                    MODULE
                                                                </span>
                                                                <h6 class="mb-0 fw-bold">{{ item.title }}</h6>
                                                                <span class="badge bg-secondary ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-2 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.learningObjectives %}
                                                                <div class="ms-4 mb-2">
                                                                    <strong class="small">Objectifs :</strong>
                                                                    <ul class="small text-muted mb-0">
                                                                        {% for objective in item.learningObjectives|slice(0, 3) %}
                                                                            <li>{{ objective }}</li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% elseif item.type == 'chapter' %}
                                                        {% set currentChapter = item %}
                                                        <div class="mb-3 ms-3">
                                                            <div class="d-flex align-items-center mb-2">
                                                                <span class="badge bg-info me-2">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="14" height="14" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                        <path d="M14 3v4a1 1 0 0 0 1 1h4"/>
                                                                        <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z"/>
                                                                    </svg>
                                                                    CHAPITRE
                                                                </span>
                                                                <h6 class="mb-0">{{ item.title }}</h6>
                                                                <span class="badge bg-secondary ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-2 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.learningObjectives %}
                                                                <div class="ms-4 mb-2">
                                                                    <strong class="small">Objectifs :</strong>
                                                                    <ul class="small text-muted mb-0">
                                                                        {% for objective in item.learningObjectives|slice(0, 2) %}
                                                                            <li>{{ objective }}</li>
                                                                        {% endfor %}
                                                                    </ul>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% elseif item.type == 'course' %}
                                                        <div class="mb-2 ms-5">
                                                            <div class="d-flex align-items-center mb-1">
                                                                <span class="badge bg-success me-2">
                                                                    {% if item.courseType == 'QCM' %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M9 12l2 2l4 -4"/>
                                                                            <path d="M21 12c0 4.97 -4.03 9 -9 9s-9 -4.03 -9 -9s4.03 -9 9 -9s9 4.03 9 9z"/>
                                                                        </svg>
                                                                        QCM
                                                                    {% elseif item.courseType == 'Exercise' %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M12 6l0 12"/>
                                                                            <path d="M6 12l12 0"/>
                                                                        </svg>
                                                                        EXERCICE
                                                                    {% else %}
                                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon me-1" width="12" height="12" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                                                            <path d="M7 4v16l13 -8z"/>
                                                                        </svg>
                                                                        COURS
                                                                    {% endif %}
                                                                </span>
                                                                <span class="small fw-medium">{{ item.title }}</span>
                                                                <span class="badge bg-light text-dark ms-auto">{{ scheduleService.formatDuration(item.durationMinutes) }}</span>
                                                            </div>
                                                            {% if item.description %}
                                                                <p class="text-muted small mb-1 ms-4">{{ item.description }}</p>
                                                            {% endif %}
                                                            {% if item.exerciseCount > 0 or item.qcmCount > 0 %}
                                                                <div class="ms-4 small text-muted">
                                                                    {% if item.exerciseCount > 0 %}
                                                                        <span class="badge bg-warning text-dark me-1">{{ item.exerciseCount }} exercice{{ item.exerciseCount > 1 ? 's' : '' }}</span>
                                                                    {% endif %}
                                                                    {% if item.qcmCount > 0 %}
                                                                        <span class="badge bg-info text-white">{{ item.qcmCount }} QCM{{ item.qcmCount > 1 ? 's' : '' }}</span>
                                                                    {% endif %}
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% else %}
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="empty">
                            <div class="empty-img">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon empty-img-icon" width="128" height="128" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                    <path d="M4 5m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"/>
                                    <path d="M16 3l0 4"/>
                                    <path d="M8 3l0 4"/>
                                    <path d="M4 11l16 0"/>
                                </svg>
                            </div>
                            <p class="empty-title">Aucun planning disponible</p>
                            <p class="empty-subtitle text-muted">
                                Cette formation n'a pas de modules configurés ou tous les modules sont inactifs.
                            </p>
                            <div class="empty-action">
                                <a href="{{ path('admin_formation_edit', {id: formation.id}) }}" class="btn btn-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                        <path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"/>
                                        <path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"/>
                                        <path d="M16 5l3 3"/>
                                    </svg>
                                    Configurer la formation
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* Segment styles */
        .continuation-segment {
            border-left: 3px solid #17a2b8;
            padding-left: 1rem;
            margin-left: 0.5rem;
        }
        
        .continuation-segment .avatar {
            opacity: 0.7;
        }
        
        .segment-progress {
            background-color: rgba(13, 110, 253, 0.1);
            border-radius: 0.375rem;
            padding: 0.25rem 0.5rem;
            margin-top: 0.5rem;
            border: 1px solid rgba(13, 110, 253, 0.2);
        }
        
        .segment-info {
            font-size: 0.75rem;
            color: #6c757d;
            background-color: #f8f9fa;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            display: inline-block;
        }
        
        /* Item highlight on hover */
        .schedule-item:hover {
            background-color: #f8f9fa;
            border-radius: 0.375rem;
            padding: 0.5rem;
            margin: -0.5rem;
        }
        
        /* Better spacing for session headers */
        .session-header {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Progress bar enhancements */
        .progress-sm {
            height: 0.25rem;
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
        
        /* Badge enhancements */
        .badge-segment {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .badge-continuation {
            background: linear-gradient(135deg, #fd7e14 0%, #e55a00 100%);
            border: 1px solid rgba(255,255,255,0.2);
        }
    </style>
{% endblock %}
